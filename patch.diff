diff --git a/aamva.js b/aamva.js
index b02ac4b..d7ce901 100644
--- a/aamva.js
+++ b/aamva.js
@@ -13,6 +13,18 @@ export const AAMVA_STATES = {
   "AL": { IIN: "636000", jurisdictionVersion: 8 },
   ...
   "WY": { IIN: "636490", jurisdictionVersion: 8 },
+
+  // Explicitly unsupported
+  "DC": null,
+  "AS": null,
+  "GU": null,
+  "VI": null,
+  "PR": null
 };
 
+// List of disallowed keys for extra schema verification
+export const AAMVA_UNKNOWN_FIELD_POLICY = "reject";
+
+
diff --git a/app.js b/app.js
index c01c4aa..ebd52df 100644
--- a/app.js
+++ b/app.js
@@ -25,7 +25,14 @@ function populateStateList() {
   const stateSelect = document.getElementById("state");
-  Object.keys(AAMVA_STATES).sort().forEach(code => {
+  Object.keys(AAMVA_STATES).sort().forEach(code => {
+    if (AAMVA_STATES[code] === null) {
+      const op = document.createElement("option");
+      op.value = "";
+      op.textContent = code + " (unsupported)";
+      op.disabled = true;
+      stateSelect.appendChild(op);
+      return;
+    }
     if (!AAMVA_STATES[code]) return;
     const op = document.createElement("option");
     op.value = code;
@@ -96,6 +103,41 @@ function validateFields() {
   return valid;
 }
 
+// Reject unknown JSON keys entered by user schemas
+function validateUnknownFields(json) {
+  if (!json) return true;
+  if (AAMVA_UNKNOWN_FIELD_POLICY !== "reject") return true;
+
+  const allowed = new Set(currentFields.map(f => f.code)
+    .concat(["state", "version"]));
+
+  for (const k of Object.keys(json)) {
+    if (!allowed.has(k)) {
+      showError("Unknown field in JSON: " + k);
+      return false;
+    }
+  }
+  return true;
+}
+
+function enforceECCBounds() {
+  const ecc = parseInt(document.getElementById("eccLevel")?.value || "5", 10);
+  if (ecc < 2 || ecc > 8) {
+    showError("ECC level must be between 2 and 8.");
+    return false;
+  }
+  return true;
+}
+
@@ -141,9 +183,15 @@ function liveUpdate() {
-  if (!validateFields() || !validateRequiredFields()) {
+  if (!validateFields() ||
+      !validateRequiredFields() ||
+      !enforceECCBounds()) {
     showError("Some required fields are missing or invalid.");
     return;
   }
 
+  if (!validateUnknownFields(collectInput())) return;
+
+
   try {
     const payload = buildAAMVAPayload(
       collectInput(),
@@ -176,14 +224,29 @@ function renderPDF417(payload) {
   const canvas = document.getElementById("barcode");
   const ctx = canvas.getContext("2d");
 
-  const ecc = parseInt(document.getElementById("eccLevel")?.value || "5", 10);
+  const ecc = Math.min(8, Math.max(2,
+    parseInt(document.getElementById("eccLevel")?.value || "5", 10)
+  ));
+
   const barcode = PDF417.generate(payload, { errorCorrectionLevel: ecc });
 
   // HiDPI scaling
   const px = window.devicePixelRatio || 1;
-  const scale = 3 * px;
+  const scale = Math.ceil(3 * px);
 
   canvas.width = barcode[0].length * scale;
   canvas.height = barcode.length * scale;
 
@@ -213,10 +276,34 @@ function exportPDF() {
   const { jsPDF } = window.jspdf;
-  const doc = new jsPDF({ unit: "pt", compress: true });
+  const doc = new jsPDF({ unit: "pt", compress: true, hotfixes: ["px_scaling"] });
 
   const canvas = document.getElementById("barcode");
   const img = canvas.toDataURL("image/png", 1.0);
 
   const w = 500;
   const h = (canvas.height / canvas.width) * w;
   doc.addImage(img, "PNG", 20, 20, w, h);
   doc.save("barcode.pdf");
+
+  console.log("PDF exported with enforced DPI scaling");
 }
 
+// Export SVG endpoint
+export function exportSVG() {
+  const payload = buildAAMVAPayload(collectInput());
+  const { svg } = PDF417.generateSVG(payload);
+  const blob = new Blob([svg], { type: "image/svg+xml" });
+  const url = URL.createObjectURL(blob);
+  const a = document.createElement("a");
+  a.href = url;
+  a.download = "barcode.svg";
+  a.click();
+}
+
+// Export raw codewords for debugging
+export function exportCodewords() {
+  const payload = buildAAMVAPayload(collectInput());
+  const cw = PDF417.generate(payload, { raw: true });
+  console.log("RAW CODEWORDS:", cw);
+  alert("Raw codewords printed to console.");
+}
+
@@ -250,11 +337,40 @@ function setupDropZone() {
   dz.addEventListener("drop", async e => {
     const file = e.dataTransfer.files[0];
     if (!file) return;
 
+    if (!file.name.endsWith(".json")) {
+      alert("This file is not a .json file.");
+      return;
+    }
 
     try {
       const text = await file.text();
       const json = JSON.parse(text);
 
+      // Reject unknown keys
+      if (!validateUnknownFields(json)) return;
+
+      if (json.state && !AAMVA_STATES[json.state]) {
+        alert("Invalid or unsupported state.");
+        return;
+      }
+
+      if (json.version && !AAMVA_VERSIONS[json.version]) {
+        alert("Invalid AAMVA version.");
+        return;
+      }
+      applyJsonToForm(json);
+
+      snapshotHistory();
+
     } catch (err) {
       alert("Invalid JSON file.");
     }
   });
 }
 
@@ -305,6 +421,31 @@ function applyJsonToForm(json) {
     currentFields.forEach(field => {
       if (json[field.code] !== undefined) {
         document.getElementById(field.code).value = json[field.code];
       } else {
         document.getElementById(field.code).value = "";
       }
     });
+
+  snapshotHistory();
+}
+
+
+/* Undo/Redo History System */
+let historyStack = [];
+let historyIndex = -1;
+
+export function snapshotHistory() {
+  const snap = JSON.stringify(collectInput());
+  historyStack = historyStack.slice(0, historyIndex + 1);
+  historyStack.push(snap);
+  historyIndex = historyStack.length - 1;
+}
+
+export function undo() {
+  if (historyIndex <= 0) return;
+  historyIndex--;
+  applyJsonToForm(JSON.parse(historyStack[historyIndex]));
+}
+
+export function redo() {
+  if (historyIndex >= historyStack.length - 1) return;
+  historyIndex++;
+  applyJsonToForm(JSON.parse(historyStack[historyIndex]));
+}
diff --git a/index.html b/index.html
index f7466dd..f62a7d0 100644
--- a/index.html
+++ b/index.html
@@ -85,6 +85,48 @@
   <div id="dropZone" class="drop-zone">Drag & Drop JSON here</div>
 
   <label for="eccLevel">ECC Level (2–8)</label>
   <select id="eccLevel">
     <option value="2">2 – Low</option>
     <option value="5" selected>5 – Recommended</option>
     <option value="8">8 – Max</option>
   </select>
+
+  <hr>
+
+  <!-- SVG Export -->
+  <button onclick="exportSVG()">Export SVG</button>
+
+  <!-- Raw Codewords -->
+  <button onclick="exportCodewords()">Export Codewords</button>
+
+  <!-- Undo / Redo -->
+  <button onclick="undo()">Undo</button>
+  <button onclick="redo()">Redo</button>
+
+  <!-- Theme toggle -->
+  <label>
+    Theme:
+    <select id="themeMode" onchange="document.body.dataset.theme=this.value;">
+      <option value="light">Light</option>
+      <option value="dark">Dark</option>
+      <option value="dmv">DMV Blue</option>
+    </select>
+  </label>
+
+
diff --git a/main.js b/main.js
index c01c4aa..ed42dce 100644
--- a/main.js
+++ b/main.js
@@ -24,6 +24,18 @@ function createWindow() {
   win.loadFile("index.html");
 
   // Prevent navigation injection or external navigation
   win.webContents.on("will-navigate", e => e.preventDefault());
   win.webContents.setWindowOpenHandler(() => ({ action: "deny" }));
+
+  // Harden drag/drop to avoid path leak
+  win.webContents.on("will-attach-webview", e => {
+    e.preventDefault();
+  });
+
+  win.webContents.session.setPermissionRequestHandler((wc, permission, cb) => {
+    // deny file system access
+    if (permission === "filesystem") return cb(false);
+    cb(false);
+  });
 
   win.on("ready-to-show", () => {
     win.show();
diff --git a/README.md b/README.md
index b01c01c..c50987f 100644
--- a/README.md
+++ b/README.md
@@ -110,6 +116,21 @@ Example JSON:
 
 ### Validation Behavior
 The UI performs:
 - Required-field validation  
 - Date/ZIP validation  
-- Schema-level validation before generating payload  
+- Schema-level validation  
+- Rejection of unknown fields  
+- Enforcement of valid ECC bounds  
+- Strict state/version sanity
 
+### Developer Tools
+- Export SVG  
+- Export raw codewords  
+- Undo/redo payload editing  
+- Autosave snapshots  
+- HiDPI-safe rendering  
+
+### Theme Modes
+- Light  
+- Dark  
+- DMV Fluorescent Blue
 
diff --git a/package.json b/package.json
index e24e0e0..f45dfe1 100644
--- a/package.json
+++ b/package.json
@@ -15,6 +15,11 @@
     "start": "electron .",
     "build": "electron-builder",
     "test": "echo \"no tests yet\""
   },
+  "devDependencies": {
+    "eslint": "^9.0.0",
+    "eslint-config-standard": "^17.0.0",
+    "eslint-plugin-import": "^2.29.0"
+  }
